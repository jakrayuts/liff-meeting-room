<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>จองห้องประชุม</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h2>จองห้องประชุม 1</h2>
  <form id="bookingForm">
    ชื่อ: <input type="text" id="name"><br><br>
    หัวข้อประชุม: <input type="text" id="objective"><br><br>
    วันที่: <input type="date" id="date"><br><br>
    เวลาเริ่ม: <input type="time" id="startTime"><br><br>
    เวลาสิ้นสุด: <input type="time" id="endTime"><br><br>
    <button type="submit">ส่งคำจอง</button>
  </form>

  <script>
    const webhookUrl = "https://script.google.com/a/macros/p-cal.com/s/AKfycbxOzdPYtGG3qoSixgIGIkRBYxsOJV3z9ck6MDuho_0_t05rTEKdiPIQsRqLalptazU/exec"; // ใส่ URL Web App ของคุณ

    async function sendBooking(data) {
      const response = await fetch(webhookUrl, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });
      const result = await response.text();
      alert(result);
      liff.closeWindow();
    }

    document.getElementById("bookingForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const data = {
        name: document.getElementById("name").value,
        objective: document.getElementById("objective").value,
        date: document.getElementById("date").value,
        startTime: document.getElementById("startTime").value,
        endTime: document.getElementById("endTime").value
      };

      sendBooking(data);
    });

    // เริ่ม LIFF
    liff.init({ liffId: "YOUR_LIFF_ID" }).then(() => {
      liff.getProfile().then(profile => {
        document.getElementById("name").value = profile.displayName;
      });
    });
  </script>
</body>
</html>
